library(survival)

# An example from Brendan Caroll
# It goes wrong because the data is not sorted

ages <- data.frame( id = c(1L, 2L, 5L, 6L, 9L, 10L, 12L, 13L, 14L, 15L, 16L,
 17L, 18L, 20L, 21L, 24L, 26L, 27L, 28L, 29L, 30L, 31L, 34L, 35L, 36L, 37L, 
38L, 39L, 40L, 42L, 45L, 46L, 43L, 48L, 49L, 50L, 51L, 52L, 54L, 55L, 57L, 
58L, 59L, 60L, 61L, 62L, 63L, 64L, 65L, 66L, 68L, 69L, 70L, 71L, 72L, 73L, 
74L, 75L, 8L, 19L, 22L, 23L, 33L, 41L), 
                   age = c(13668, 21550, 15249, 21550, 
16045, 21550, 14976, 14976, 6574, 21550, 4463, 16927, 16927, 15706, 4567, 
21306, 17235, 22158, 19692, 17632, 17597, 4383, 5811, 7704, 5063, 17351, 
17015, 16801, 4383, 5080, 13185, 12604, 19784, 5310, 15369, 13239, 1638, 
21323, 10914, 21262, 7297, 17214, 17508, 14199, 14062, 2227, 8434, 4593, 
14429, 21323, 4782, 10813, 2667, 2853, 5709, 3140, 12237, 7882, 21550, 
15553, 16466, 16621, 19534, 21842))

transitions <- data.frame(id=c(2,2, 6, 8, 10, 19, 22, 23, 24, 31, 
                               33, 41, 43, 43, 52, 55, 66),
                          transition = c(18993, 13668, 15249, 15706, 15887, 
                                         11609, 4023, 9316, 16193, 1461, 
                                         4584, 17824, 3713, 11261, 16818, 
                                         10670, 15479))

tdata  <- tmerge(ages, ages, id=id, tstop=age)
newdata<- tmerge(tdata, transitions, id=id, transition=cumtdc(transition))

